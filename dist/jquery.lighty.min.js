/*! jq Lighty - v0.0.1 - 2012-06-10
* Copyright (c) 2012 Andreas Hultgren; Licensed MIT */
(function(a){function b(){this.settings={baseZ:5,data:function(){return{jsonposts:1}},prefix:"lighty-",itemTemplate:function(a,b){var c='<img src="'+a[0].the_post_thumbnail[0]+'" />'+'<p class="desc">'+a[0].the_excerpt+"</p>";return{markup:c,width:a[0].the_post_thumbnail[1],height:a[0].the_post_thumbnail[2]}},load:function(c,d){var e=this;return d.show(),c.empty().append('<div class="'+b.prefix+'waiter"></div>').css({top:e.offset().top-a(window).scrollTop(),left:e.offset().left,width:e.width(),height:e.height()}).show(),e}};var b=this.settings,c,d,e,f,g=function(){var f=a(this);return e=f,b.load.call(f,d,c),a.ajax({url:f.attr("href"),data:b.data.call(f),dataType:"json",error:function(a,b){},success:function(a){var e=b.itemTemplate.call(this,a,c);d.lighty("resize",{width:e.width,height:e.height},function(){d.empty().append(e.markup)})}}),this},h=function(){c.hide(),d.hide().empty(),e=undefined};this.init=function(i){return f=this,a.extend(b,i),c=a(document.createElement("div")).attr("id",b.prefix+"bg").css({position:"fixed",top:0,left:0,right:0,bottom:0,"z-index":b.baseZ}).hide().appendTo("body").click(function(){h()}),d=a(document.createElement("div")).attr("id",b.prefix+"container").css({position:"fixed",left:a(window).width()/2,top:a(window).height()/2,"z-index":b.baseZ+1}).hide().appendTo("body"),a(window).keydown(function(a){var b;e&&(a.which===39?(a.preventDefault(),b=f[f.index(e)+1]):a.which===37&&(a.preventDefault(),b=f[f.index(e)-1]),b?g.call(b):(!b&&(a.which===39||a.which===37)||a.which===27)&&h())}),this.each(function(){a(this).click(function(a){a.preventDefault(),g.call(this)})})},this.resize=function(b,c){return this.each(function(){var d=a(window),e=d.width(),f=d.height(),g=a(this),h;b=b||{},b.height=b.height||g.height(),b.width=b.width||g.width(),b.width>e-50&&(h=(e-50)/b.width,b.width*=h,b.height*=h),b.height>f-100&&(h=(f-100)/b.height,b.width*=h,b.height*=h),g.animate({width:b.width,height:b.height,left:e/2-b.width/2,top:f/2-b.height/2},{duration:200,complete:function(){g.height("auto"),typeof c=="function"&&c()}})})}}a.fn.lighty=function(c){if(this.length){var d=new b;if(d[c])return d[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return d.init.apply(this,arguments);a.error("Method "+c+" does not exist on jQuery.lighty")}}})(jQuery);